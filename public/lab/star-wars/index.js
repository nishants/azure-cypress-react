(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){window.app=angular.module("galaxy",[])},{}],2:[function(require,module,exports){app.directive("fullscreen",[function(){return{restrict:"A",scope:false,link:function(scope,element){element.on("click",function(){var el=document.documentElement,rfs=el.requestFullscreen||el.webkitRequestFullScreen||el.mozRequestFullScreen||el.msRequestFullscreen;rfs.call(el)})}}}])},{}],3:[function(require,module,exports){app.directive("gameProgress",["MissionsService",function(MissionsService){var states={4:"zero",3:"one",2:"two",1:"three",0:"four"};return{restrict:"C",scope:true,link:function(scope){scope.progress={state:states[MissionsService.remaining()]};scope.$watch(function(){return MissionsService.remaining()},function(value){scope.progress.state=states[value]})}}}])},{}],4:[function(require,module,exports){app.value("remote","https://findfalcone.herokuapp.com");app.value("requestConfig",{headers:{Accept:"application/json","Content-Type":"application/json"}});app.run(["remote","$http","requestConfig","PlanetsService","VehiclesService",function(remote,$http,requestConfig,PlanetsService,VehiclesService){PlanetsService.load();VehiclesService.load()}])},{}],5:[function(require,module,exports){app.controller("WizardController",["$scope","PlanetsService","VehiclesService","CreateMissionService",function($scope,PlanetsService,VehiclesService,CreateMissionService){$scope.planets=PlanetsService;$scope.vehicles=VehiclesService;$scope.wizard=CreateMissionService}])},{}],6:[function(require,module,exports){app.service("CreateMissionService",["MissionsService","$timeout",function(MissionsService){var wizard={planet:null,vehicle:null,showWizard:false,selectVehicle:false,show:function(){wizard.showWizard=true},isSelectable:function(vehicle){return wizard.planet&&vehicle.max_distance>=wizard.planet.distance},showVehicle:function(selectVehicle){wizard.selectVehicle=selectVehicle},setVehicle:function(vehicle){wizard.vehicle=vehicle;wizard.showWizard=false;wizard.confirm()},setPlanet:function(planet){wizard.planet=planet;wizard.showVehicle(true)},confirm:function(){MissionsService.add(wizard.planet,wizard.vehicle);wizard.reset()},reset:function(){wizard.planet=null;wizard.vehicle=null;wizard.showWizard=false;wizard.selectVehicle=false}};wizard.reset();return wizard}])},{}],7:[function(require,module,exports){app.service("HelpService",[function(){var help={message:function(missions,ui){return help.states.find(function(state){return state.select(missions,ui)}).message(missions,ui)},states:[{name:"no-missions",message:function(){return"Create a mission"},select:function(missions){return missions.list.length==0}},{name:"need-more-missions",message:function(missions){var remainingMissions=missions.remaining(),moreThanOne=remainingMissions>1;return"Create <count> more mission<s>".replace("<count>",remainingMissions).replace("<s>",moreThanOne?"s":"")},select:function(missions){return missions.list.length>0&&missions.remaining()>0}},{name:"send-mission",message:function(){return"Send Missionaries"},select:function(missions){return missions.remaining()==0}}]};return help}])},{}],8:[function(require,module,exports){app.controller("MissionsController",["$scope","HelpService","MissionsService","CreateMissionService","ResultService",function($scope,HelpService,MissionsService,CreateMissionService,ResultService){$scope.missions=MissionsService;$scope.help=HelpService;$scope.createMission=function(){MissionsService.remaining()?CreateMissionService.show():ResultService.submit(MissionsService.list)}}])},{}],9:[function(require,module,exports){app.service("MissionsService",[function(){var MAX_MISSIONS=4,missions={add:function(planet,vehicle){planet.assign();vehicle.assign();missions.list.push({planet:planet,vehicle:vehicle})},remaining:function(){return MAX_MISSIONS-missions.list.length},reset:function(){while(missions.remaining()<MAX_MISSIONS){missions.remove(0)}},remove:function(index){var mission=missions.list[index];mission.planet.unassign();mission.vehicle.unassign();missions.list.splice(index,1)},list:[]};return missions}])},{}],10:[function(require,module,exports){app.service("PlanetsService",["$http","remote","requestConfig","planetIcons",function($http,remote,requestConfig,planetIcons){var toPlanets=function(data){var planet={name:data.name,distance:data.distance,assigned:false,icon:planetIcons[data.name]||planetIcons["other"],assign:function(){planet.assigned=true},unassign:function(){planet.assigned=false}};return planet};var planets={list:[],load:function(){return $http.get(remote+"/planets",{},requestConfig).then(function(response){planets.list=response.data.map(toPlanets)})}};return planets}])},{}],11:[function(require,module,exports){app.controller("ResultController",["$scope","ResultService","$window","MissionsService",function($scope,ResultService,$window,MissionsService){$scope.result=ResultService;$scope.playAgain=function(){MissionsService.reset();ResultService.reset()}}])},{}],12:[function(require,module,exports){app.service("ResultService",["$http","remote","requestConfig",function($http,remote,requestConfig){var planetNames=function(mission){return mission.planet.name},vehicleNames=function(mission){return mission.vehicle.name},vehicleFor=function(planetName){return function(mission){return mission.planet.name==planetName}},service={loading:false,outcome:null,reset:function(){service.loading=false;service.outcome=null},submit:function(missionList){service.loading=true;return $http.post(remote+"/token",{},requestConfig).then(function(response){var token=response.data.token,request={token:token,planet_names:missionList.map(planetNames),vehicle_names:missionList.map(vehicleNames)};return $http.post(remote+"/find",request,requestConfig).then(function(response){service.outcome={planet_name:response.data.planet_name,status:response.data.status!="false",vehicle_name:response.data.planet_name?missionList.find(vehicleFor(response.data.planet_name)).vehicle.name:null};service.loading=false})})}};return service}])},{}],13:[function(require,module,exports){app.value("planetIcons",{Donlon:"images/planets/Donlon.png",Enchai:"images/planets/Enchai.ico",Jebing:"images/planets/Jebing.png",Sapir:"images/planets/Sapir.png",Lerbin:"images/planets/Lerbin.jpg",Pingasor:"images/planets/Pingasor.ico",other:"images/planets/other-planet.png"});app.value("vehicleIcons",{"Space pod":"images/vehicles/space-pod.jpg","Space rocket":"images/vehicles/space-rocket.png","Space shuttle":"images/vehicles/shutle.jpeg","Space ship":"images/vehicles/spaceship.png",other:"images/vehicles/other-vehicle.jpg"})},{}],14:[function(require,module,exports){app.service("VehiclesService",["$http","remote","requestConfig","vehicleIcons",function($http,remote,requestConfig,vehicleIcons){var withIcons=function(data){var vehicle={name:data.name,speed:data.speed,icon:vehicleIcons[data.name]||vehicleIcons["other"],remaining:data.total_no,total_no:data.total_no,max_distance:data.max_distance,assign:function(){--vehicle.remaining},unassign:function(){++vehicle.remaining}};return vehicle};var vehicles={list:[],load:function(){$http.get(remote+"/vehicles",{},requestConfig).then(function(response){vehicles.list=response.data.map(withIcons)})}};return vehicles}])},{}],15:[function(require,module,exports){require("./app/app.js");require("./app/variables.js");require("./app/config.js");require("./app/result/result-service.js");require("./app/result/result-controller.js");require("./app/list-missions/missions-service.js");require("./app/list-missions/missions-controller.js");require("./app/help/help-service.js");require("./app/components/game-progress.js");require("./app/components/fullscreen.js");require("./app/planets/planets-service.js");require("./app/vehicles/vehicles-service.js");require("./app/create-missions/create-mission-controller.js");require("./app/create-missions/create-mission-service.js")},{"./app/app.js":1,"./app/components/fullscreen.js":2,"./app/components/game-progress.js":3,"./app/config.js":4,"./app/create-missions/create-mission-controller.js":5,"./app/create-missions/create-mission-service.js":6,"./app/help/help-service.js":7,"./app/list-missions/missions-controller.js":8,"./app/list-missions/missions-service.js":9,"./app/planets/planets-service.js":10,"./app/result/result-controller.js":11,"./app/result/result-service.js":12,"./app/variables.js":13,"./app/vehicles/vehicles-service.js":14}]},{},[15]);
